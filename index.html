<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TEST BAHASA KOREA</title>

<style>
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to   { opacity: 1; transform: translateY(0); }
}

html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  overflow: hidden;
}

body {
  font-family: 'Segoe UI', system-ui, Arial, sans-serif;
  min-height: 100vh;
  background: url('https://raw.githubusercontent.com/airnetcso/eps/main/image/bg1.jpg') no-repeat center center fixed;
  background-size: cover;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 20px;
  color: #fff;
  position: relative;
}

body::before {
  content: '';
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.3);
  z-index: 1;
}

/* LOGIN PAGE - Mirip Koka */
.login-container {
  position: relative;
  z-index: 2;
  width: 80%;
  max-width: 440px;
  background: rgba(255,255,255,0.15);
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
  border-radius: 24px;
  padding: 40px 30px;
  box-shadow: 0 15px 40px rgba(0,0,0,0.35);
  border: 1px solid rgba(255,255,255,0.18);
  animation: fadeIn 0.8s ease-out;
  margin-top: -100px;
  text-align: center;
}

.login-container h1 {
  font-size: 32px;
  margin: 0 0 10px;
  color: #fff;
  font-weight: 700;
  text-shadow: 0 2px 8px rgba(0,0,0,0.6);
}

.login-container p {
  margin: 0 0 30px;
  font-size: 18px;
}

input {
  width: 100%;
  padding: 16px;
  margin: 14px 0;
  font-size: 18px;
  border: 2px solid rgba(255,255,255,0.4);
  border-radius: 12px;
  box-sizing: border-box;
  background: rgba(255,255,255,0.12);
  color: white;
  transition: all 0.3s ease;
}

input::placeholder {
  color: rgba(255,255,255,0.7);
}

input:focus {
  border-color: #fff;
  background: rgba(255,255,255,0.22);
  outline: none;
  box-shadow: 0 0 0 4px rgba(255,255,255,0.15);
}

button {
  width: 100%;
  padding: 16px;
  margin: 16px 0 8px;
  font-size: 20px;
  font-weight: bold;
  border: none;
  border-radius: 12px;
  color: white;
  cursor: pointer;
  background: linear-gradient(90deg, #3b82f6, #2563eb);
  transition: all 0.3s ease;
}

button:hover {
  transform: translateY(-3px);
  box-shadow: 0 12px 25px rgba(59,130,246,0.4);
}

.error {
  color: #ff6b6b;
  text-align: center;
  margin: 12px 0;
  font-weight: 600;
  background: rgba(0,0,0,0.4);
  padding: 10px;
  border-radius: 10px;
}

/* QUIZ PAGE - Tetap seperti asli */
#quiz-page{display:none;min-height:100vh;padding:70px 0;background:linear-gradient(#fdf6ec,#f7efe2)}
.header-fixed{
 position:fixed;top:0;width:100%;display:flex;gap:6px;
 background:#fff;padding:6px;z-index:1000
}
.timer,.submit-top{flex:1;padding:12px 0;text-align:center;color:#fff;font-weight:bold}
.timer{background:#4caf50}
.submit-top{background:#f44336}

.container{max-width:540px;margin:auto;height:calc(100vh - 140px);overflow:auto}
.question-wrapper{display:none;margin-bottom:30px}
.question-wrapper.active{display:block}

.box-passage{background:#e3f2fd;padding:20px;border:2px solid #bbdefb}
.box-passage audio,.box-passage img{width:100%;margin-top:10px}

.box-question{background:#fff3e0;padding:20px;border:2px solid #ffcc80}

.options{margin-top:15px}
.option-item{display:flex;align-items:flex-start;margin:12px 0}
.option-item input{display:none}
.option-circle{
 width:28px;height:28px;border:1.5px solid #000;border-radius:50%;
 display:flex;align-items:center;justify-content:center;margin-right:10px
}
.option-item input:checked + .option-circle{background:#bbdefb}

.nav-bottom{
 position:fixed;bottom:0;width:100%;display:flex;gap:6px;
 background:#fff;padding:6px
}
.nav-bottom button{flex:1;padding:12px;color:#fff;border:none;font-weight:bold}
#prev{background:#2196f3}
#next{background:#ff9800}

/* RESULT */
#result-page{display:none;max-width:600px;margin:auto;padding:20px}
.result-box{background:#fff;border:2px solid #ddd;padding:20px}
.wrong-item{
 margin-top:15px;padding:12px;
 background:#ffebee;border-left:5px solid #f44336
}
.correct{color:green;font-weight:bold}
.back-btn{
 margin-top:20px;padding:14px;
 background:#3f51b5;color:#fff;text-align:center;cursor:pointer
}
</style>
</head>

<body>

<!-- LOGIN PAGE (UI baru mirip koka + ID login-page dikembalikan) -->
<div class="login-container" id="login-page">
  <h1>LATIHAN SOAL</h1>
  <h1>ÌïúÍµ≠Ïñ¥Ïó∞Ïäµ</h1>
  <p>25 Soal | 50 Menit</p>

  <input id="username" placeholder="Username / Ïù¥Î¶Ñ" autocomplete="off">
  <input id="password" type="password" placeholder="Password / ÎπÑÎ∞ÄÎ≤àÌò∏" autocomplete="off">
  <input id="kode" placeholder="Kode Soal / ÏãúÌóòÏΩîÎìú" autocomplete="off">

  <div class="error" id="errorMsg"></div>

  <button id="btnLogin">LOGIN / Î°úÍ∑∏Ïù∏</button>
</div>

<!-- QUIZ PAGE (tetap seperti asli) -->
<div id="quiz-page">
 <div class="header-fixed">
 <div class="submit-top" id="submitTop">SUBMIT</div>
 <div class="timer" id="timer">50:00</div>
 </div>
 <div class="container"><form id="quiz-form"></form></div>
 <div class="nav-bottom">
 <button id="prev">PREV</button>
 <button id="next">NEXT</button>
 </div>
</div>

<!-- RESULT PAGE -->
<div id="result-page">
 <div class="result-box" id="resultBox"></div>
</div>

<script>
document.addEventListener("DOMContentLoaded",()=>{

const loginPage=document.getElementById("login-page");
const quizPage=document.getElementById("quiz-page");
const resultPage=document.getElementById("result-page");
const btnLogin=document.getElementById("btnLogin");
const submitTop=document.getElementById("submitTop");
const quizForm=document.getElementById("quiz-form");
const timerEl=document.getElementById("timer");
const resultBox=document.getElementById("resultBox");

const validCredentials={
 "uus":"123","user01":"12345","hanarizka":"Nungkihana24!","user3":"12345","siswa01":"12345",
 "windi":"Windi2000","rismaya97":"bahasakorea","admin":"admin123","Fikrisurya":"464646",
 "Mutiara2003":"Mutiara14","sita77":"minyooki","Aini185":"Doraemon","Hangeulfei":"studykorea02",
 "Hamdan106":"Fukuo106","koreafan":"hanguk789","topik2026":"seoul2026"
};
const kodeMapping={
 "B12345":"soal1.json","A09008":"soal2.json","SAREWAE":"soal5.json",
 "W11765":"soal3.json","H66633":"soal4.json"
};
const BASE="https://raw.githubusercontent.com/airnetcso/latbakor/main/soal/";

let questions=[],answers=[],current=0,time=3000,interval;
let currentUser="", currentKode="";

btnLogin.onclick=()=>{
 const u=document.getElementById("username").value.trim();
 const p=document.getElementById("password").value.trim();
 const k=document.getElementById("kode").value.trim().toUpperCase();

 if(validCredentials[u]===p && kodeMapping[k]){
  currentUser = u;
  currentKode = k;
  loginPage.style.display="none";
  quizPage.style.display="block";
  loadSoal(kodeMapping[k]);
  startTimer();
 }else{
  alert("Username / Password / Kode salah");
 }
};

async function loadSoal(file){
 questions=await (await fetch(BASE+file)).json();
 answers=Array(questions.length).fill(null);
 quizForm.innerHTML="";
 questions.forEach((q,i)=>{
  quizForm.innerHTML+=`
   <div class="question-wrapper">
   <div class="box-passage">
   ${q.audio?`<audio controls src="${q.audio}"></audio>`:""}
   ${q.image?`<img src="${q.image}">`:""}
   </div>
   <div class="box-question">
   <p><b>${i+1}.</b> ${q.question}</p>
   ${Object.entries(q.options).map(([k,v],idx)=>`
   <label class="option-item">
   <input type="radio" name="q${i}" value="${k}">
   <span class="option-circle">${idx+1}</span>${v}
   </label>`).join("")}
   </div>
   </div>`;
 });
 document.querySelectorAll("input[type=radio]").forEach(r=>{
  r.onchange=()=>answers[+r.name.slice(1)]=r.value;
 });
 show(0);
}

function show(n){
 document.querySelectorAll("audio").forEach(a=>{a.pause();a.currentTime=0});
 document.querySelectorAll(".question-wrapper").forEach((q,i)=>q.classList.toggle("active",i===n));
 current=n;
}
document.getElementById("prev").onclick=()=>current>0&&show(current-1);
document.getElementById("next").onclick=()=>current<questions.length-1&&show(current+1);

submitTop.onclick=()=>{
 const kosong=answers.findIndex(a=>a===null);
 if(kosong!==-1){alert("Soal "+(kosong+1)+" belum dijawab");show(kosong);return;}

 clearInterval(interval);
 quizPage.style.display="none";
 resultPage.style.display="block";

 let score=0,html="";
 questions.forEach((q,i)=>{
  const benar=q.answer;
  if(answers[i]===benar) score+=4;
  else html+=`
   <div class="wrong-item">
   <b>Soal ${i+1} salah</b><br>
   Jawaban benar: <span class="correct">${benar}</span><br>
   ${q.explanation||"-"}
   </div>`;
 });

 // INTEGRASI ADMIN PUSAT
 const resultData = {
  username: currentUser,
  kode: currentKode,
  nilai: score,
  tanggal: new Date().toLocaleString('id-ID'),
  app: "latbakor"
 };

 let allResults = JSON.parse(localStorage.getItem("quizResults") || "[]");
 const duplicate = allResults.some(r => r.username === resultData.username && r.kode === resultData.kode && r.nilai === resultData.nilai && r.app === "latbakor");
 if(!duplicate){
  allResults.push(resultData);
  localStorage.setItem("quizResults", JSON.stringify(allResults));
 }

 resultBox.innerHTML=`
  <h2>Nilai: ${score}</h2>
  ${html||"<p class='correct'>Semua jawaban benar üéâ</p>"}
  <div class="back-btn" onclick="location.reload()">KEMBALI</div>`;
};

function startTimer(){
 interval=setInterval(()=>{
  timerEl.textContent=String(Math.floor(time/60)).padStart(2,"0")+":"+String(time%60).padStart(2,"0");
  if(--time<0) submitTop.onclick();
 },1000);
}

});
</script>
</body>
</html>
