<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Latihan Reading Korea</title>

<style>
body{
  margin:0;
  font-family:Segoe UI, Arial, sans-serif;
  background:#f2f2f2;
}

.header{
  position:fixed;
  top:0;
  left:0;
  right:0;
  display:flex;
  justify-content:space-between;
  padding:8px 12px;
  background:#fff;
  border-bottom:1px solid #ccc;
  z-index:1000;
}

.timer, .submit-btn{
  width:90px;
  height:36px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:bold;
  font-size:14px;
}

.timer{background:#eee;}
.submit-btn{background:#ff9800;color:#fff;cursor:pointer}

.container{
  max-width:480px;
  margin:70px auto 80px;
  padding:12px;
}

.box-passage{
  background:#e3f2fd;
  padding:12px;
  margin-bottom:12px;
}

.box-question{
  background:#fff;
  padding:12px;
}

.option-item{
  display:flex;
  margin:10px 0;
  cursor:pointer;
}

.option-item input{display:none;}

.option-letter{
  width:28px;
  height:28px;
  border-radius:50%;
  border:2px solid #1976d2;
  display:flex;
  align-items:center;
  justify-content:center;
  margin-right:10px;
  color:#1976d2;
  font-weight:bold;
}

.option-item input:checked + .option-letter{
  background:#64b5f6;
  color:#fff;
}

.footer-nav{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  display:flex;
  background:#fff;
  border-top:1px solid #ccc;
}

.footer-nav button{
  flex:1;
  height:44px;
  border:none;
  font-weight:bold;
}

#resultBox{
  display:none;
  padding:16px;
}
</style>
</head>

<body>

<div class="header">
  <div class="submit-btn" onclick="submitQuiz(false)">SUBMIT</div>
  <div class="timer" id="timer">50:00</div>
</div>

<div class="container" id="quizContainer"></div>

<div class="footer-nav">
  <button onclick="prevQ()">PREV</button>
  <button onclick="nextQ()">NEXT</button>
</div>

<div class="container" id="resultBox">
  <h2>Hasil Ujian</h2>
  <div id="scoreText"></div>
  <hr>
  <div id="reviewBox"></div>
</div>

<script>
const TOTAL = 25;
const SCORE_PER = 4;
let questions = [];
let answers = Array(TOTAL).fill(null);
let current = 0;
let timeLeft = 50 * 60;
let timerInterval;

fetch("soal.json")
.then(r=>r.json())
.then(d=>{
  questions = d;
  renderQuestion();
  startTimer();
});

function startTimer(){
  timerInterval = setInterval(()=>{
    timeLeft--;
    let m = String(Math.floor(timeLeft/60)).padStart(2,"0");
    let s = String(timeLeft%60).padStart(2,"0");
    document.getElementById("timer").innerText = `${m}:${s}`;
    if(timeLeft<=0) submitQuiz(true);
  },1000);
}

function renderQuestion(){
  const q = questions[current];
  let html = "";

  if(q.audio) html += `<audio controls src="${q.audio}"></audio>`;
  if(q.image) html += `<img src="${q.image}" style="width:100%">`;

  html += `
  <div class="box-question">
    <b>Soal ${current+1}</b><br>${q.question}
  `;

  q.options.forEach((opt,i)=>{
    html+=`
    <label class="option-item">
      <input type="radio" name="opt" ${answers[current]===i?"checked":""}
        onchange="answers[${current}]=${i}">
      <span class="option-letter">${i+1}</span>
      <span>${opt}</span>
    </label>`;
  });

  html += "</div>";
  document.getElementById("quizContainer").innerHTML = html;
}

function nextQ(){ if(current<TOTAL-1){current++;renderQuestion();}}
function prevQ(){ if(current>0){current--;renderQuestion();}}

function submitQuiz(auto){
  clearInterval(timerInterval);
  let score=0, review="";
  questions.forEach((q,i)=>{
    if(answers[i]===q.correct){score+=SCORE_PER;}
    else{
      review+=`<p><b>Soal ${i+1}</b><br>${q.explanation}</p>`;
    }
  });

  document.getElementById("scoreText").innerHTML=`Nilai: <b>${score}</b>`;
  document.getElementById("reviewBox").innerHTML=review||"Semua benar ðŸŽ‰";

  localStorage.setItem("lastResult",JSON.stringify({
    score, answers, date:new Date().toLocaleString()
  }));

  document.getElementById("quizContainer").style.display="none";
  document.getElementById("resultBox").style.display="block";
}
</script>
</body>
</html>
