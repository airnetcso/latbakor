<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TEST BAHASA KOREA</title>
<style>
body{margin:0;font-family:'Segoe UI',Arial,sans-serif;background:#f5f5f5}
/* LOGIN PAGE DENGAN ANIMASI */
#login-page{
 min-height:100vh;
 display:flex;
 flex-direction:column;
 justify-content:center;
 align-items:center;
 background:linear-gradient(rgba(0,0,0,.6),rgba(0,0,0,.6)),
 url('https://raw.githubusercontent.com/airnetcso/eps/main/image/bg1.jpg') center/cover no-repeat;
}
/* ANIMASI MASUK HALUS */
@keyframes fadeSlideUp {
  from { opacity: 0; transform: translateY(40px); }
  to { opacity: 1; transform: translateY(0); }
}
.login-container{
 width:90%;
 max-width:300px;
 padding:45px 35px;
 text-align:center;
 background:rgba(255,255,255,.12);
 backdrop-filter:blur(14px);
 border-radius:24px;
 box-shadow:0 12px 40px rgba(0,0,0,.5);
 animation: fadeSlideUp 0.9s ease-out forwards;
}
.login-container h1{
 color:#fff;font-size:30px;margin:0 0 8px 0;text-shadow:0 2px 6px rgba(0,0,0,.7);
}
.login-container h1:nth-of-type(2){font-size:26px;margin-bottom:22px;}
.login-container p{color:#eee;font-size:16px;margin-bottom:32px;}
input{
 width:100%;padding:15px;margin:14px 0;border:none;border-radius:14px;
 background:rgba(255,255,255,.18);color:#fff;font-size:16px;
 backdrop-filter:blur(4px);
 box-sizing:border-box;
 transition:all 0.3s;
}
input::placeholder{
 color:rgba(255,255,255,.65);
}
input:focus{
 outline:none;background:rgba(255,255,255,.35);
 box-shadow:0 0 20px rgba(255,107,157,.6);
 transform:scale(1.02);
}
button{
 width:100%;padding:16px;margin:16px 0 8px;border:none;border-radius:14px;
 background:#ff6b9d;color:#fff;font-weight:bold;font-size:17px;cursor:pointer;
 box-shadow:0 6px 20px rgba(255,107,157,.5);
 transition:all 0.4s;
}
button:hover{
 background:#ff8ac1;
 transform:translateY(-5px) scale(1.05);
 box-shadow:0 12px 35px rgba(255,107,157,.7);
 animation: pulse 1.5s infinite;
}
@keyframes pulse {
 0%{box-shadow:0 6px 20px rgba(255,107,157,.5);}
 50%{box-shadow:0 12px 40px rgba(255,107,157,.9);}
 100%{box-shadow:0 6px 20px rgba(255,107,157,.5);}
}
/* COPYRIGHT */
.copyright{
 margin-top:35px;
 color:rgba(255,255,255,.8);
 font-size:14px;
 text-shadow:0 1px 4px rgba(0,0,0,.8);
}

/* QUIZ & RESULT */
#quiz-page{display:none;min-height:100vh;padding:70px 0;background:linear-gradient(#fdf6ec,#f7efe2)}
.header-fixed{
 position:fixed;top:0;width:100%;display:flex;justify-content:space-between;align-items:center;background:#fff;padding:6px 12px;z-index:1000;box-sizing:border-box;
}
.timer,.submit-top{
 padding:10px 20px;
 text-align:center;
 color:#fff;
 font-weight:bold;
 font-size:16px;
 border-radius:0;
 min-width:100px;
}
.timer{background:#4caf50}
.submit-top{background:#f44336}

.container{max-width:540px;margin:auto;height:calc(100vh - 140px);overflow:auto}
.question-wrapper{display:none;margin-bottom:30px}
.question-wrapper.active{display:block}
.box-passage{background:#e3f2fd;padding:20px;border:2px solid #bbdefb}
.box-passage audio,.box-passage img{width:100%;margin-top:10px}
.box-question{background:#fff3e0;padding:20px;border:2px solid #ffcc80}
.options{margin-top:15px}
.option-item{display:flex;align-items:flex-start;margin:12px 0}
.option-item input{display:none}
.option-circle{width:28px;height:28px;border:1.5px solid #000;border-radius:50%;display:flex;align-items:center;justify-content:center;margin-right:10px}
.option-item input:checked + .option-circle{background:#bbdefb}

.nav-bottom{
 position:fixed;bottom:0;width:100%;display:flex;justify-content:space-between;align-items:center;background:#fff;padding:6px 12px;box-sizing:border-box;
}
.nav-bottom button{
 padding:10px 20px;                /* EXACTLY SAMA dengan atas */
 color:#fff;
 border:none;
 font-weight:bold;
 font-size:16px;                   /* SAMA */
 border-radius:0;                  /* SAMA */
 min-width:100px;                  /* SAMA */
}
#prev{background:#2196f3}
#next{background:#ff9800}

#result-page{display:none;max-width:600px;margin:auto;padding:20px}
.result-box{background:#fff;border:2px solid #ddd;padding:20px}
.wrong-item{margin-top:15px;padding:12px;background:#ffebee;border-left:5px solid #f44336}
.correct{color:green;font-weight:bold}
.back-btn{margin-top:20px;padding:14px;background:#3f51b5;color:#fff;text-align:center;cursor:pointer;border-radius:8px;}
</style>
</head>
<body>
<div id="login-page">
 <div class="login-container">
 <h1>LATIHAN SOAL</h1>
 <h1>ÌïúÍµ≠Ïñ¥Ïó∞Ïäµ</h1>
 <p>25 Soal | 50 Menit</p>
 <input id="username" placeholder="Username / Ïù¥Î¶Ñ">
 <input id="password" type="password" placeholder="Password / ÎπÑÎ∞ÄÎ≤àÌò∏">
 <input id="kode" placeholder="Kode Soal / ÏãúÌóòÏΩîÎìú">
 <button id="btnLogin">LOGIN / Î°úÍ∑∏Ïù∏</button>
 </div>
 <div class="copyright">¬© 2026 Denzuka - Kim Jongun. All Rights Reserved.</div>
</div>

<div id="quiz-page">
 <div class="header-fixed">
  <div class="submit-top" id="submitTop">SUBMIT</div>
  <div class="timer" id="timer">50:00</div>
 </div>
 <div class="container"><form id="quiz-form"></form></div>
 <div class="nav-bottom">
  <button id="prev">PREV</button>
  <button id="next">NEXT</button>
 </div>
</div>

<div id="result-page">
 <div class="result-box" id="resultBox"></div>
</div>

<script>
const SPREADSHEET_URL = "https://script.google.com/macros/s/AKfycbzwdfNflhqIyVWo8knAyB2nWtzlkbPiRHfMCJV_O_mxkZravDprrAhMNV3Qu75WFYgk0g/exec";

document.addEventListener("DOMContentLoaded",()=>{
const loginPage=document.getElementById("login-page");
const quizPage=document.getElementById("quiz-page");
const resultPage=document.getElementById("result-page");
const btnLogin=document.getElementById("btnLogin");
const submitTop=document.getElementById("submitTop");
const quizForm=document.getElementById("quiz-form");
const timerEl=document.getElementById("timer");
const resultBox=document.getElementById("resultBox");

const validCredentials={
 "uus":"123",
 "user01":"12345",
 "hanarizka":"Nungkihana24!",
 "windi":"Windi2000",
 "rismaya97":"bahasakorea",
 "sita77":"minyooki",
 "Aini185":"Doraemon",
 "Hangeulfei":"studykorea02",
 "Hamdan106":"Fukuo106",
 "Heri":"heri99",
 "Fikrisurya":"464646",
 "Mutiara2003":"Mutiara14",
 "wantikas":"200022",
 "Dininidia":"dininidia11",
 "kaniarostayuni9":"Kania1313",
 "Dikisetiawan07":"Diki2709",
 "Aisyah18":"Aisyah18.",
 "Rizka2026":"butterfly24",
 "Zhafif07":"20060722",
 "admin":"admin123",
 "koreafan":"hanguk789",
 "topik2026":"seoul2026"
};

const kodeMapping={
 "B12345":"soal1.json",
 "A09008":"soal2.json",
 "SAREWAE":"test.json",
 "W11765":"soal3.json",
 "H66666":"soal5.json"
};

const BASE="https://raw.githubusercontent.com/airnetcso/latbakor/main/soal/";
let questions=[],answers=[],current=0,time=3000,interval;
let currentUser="", currentKode="";

btnLogin.onclick=()=>{
 const u=document.getElementById("username").value.trim();
 const p=document.getElementById("password").value.trim();
 const k=document.getElementById("kode").value.trim().toUpperCase();
 if(validCredentials[u]===p && kodeMapping[k]){
  currentUser = u;
  currentKode = k;
  loginPage.style.display="none";
  quizPage.style.display="block";
  loadSoal(kodeMapping[k]);
  startTimer();
 }else{
  alert("Username / Password / Kode salah");
 }
};

async function loadSoal(file){
 questions=await (await fetch(BASE+file)).json();
 answers=Array(questions.length).fill(null);
 quizForm.innerHTML="";
 questions.forEach((q,i)=>{
  quizForm.innerHTML+=`
  <div class="question-wrapper">
   <div class="box-passage">
    ${q.audio?`<audio controls src="${q.audio}"></audio>`:""}
    ${q.image?`<img src="${q.image}">`:""}
   </div>
   <div class="box-question">
    <p><b>${i+1}.</b> ${q.question}</p>
    ${Object.entries(q.options).map(([k,v],idx)=>`
    <label class="option-item">
     <input type="radio" name="q${i}" value="${k}">
     <span class="option-circle">${idx+1}</span> ${v}
    </label>`).join("")}
   </div>
  </div>`;
 });
 document.querySelectorAll("input[type=radio]").forEach(r=>{
  r.onchange=()=>answers[+r.name.slice(1)]=r.value;
 });
 show(0);
}

function show(n){
 document.querySelectorAll("audio").forEach(a=>{a.pause();a.currentTime=0});
 document.querySelectorAll(".question-wrapper").forEach((q,i)=>q.classList.toggle("active",i===n));
 current=n;
}

document.getElementById("prev").onclick=()=>current>0&&show(current-1);
document.getElementById("next").onclick=()=>current<questions.length-1&&show(current+1);

submitTop.onclick=()=>{
 const kosong=answers.findIndex(a=>a===null);
 if(kosong!==-1){alert("Soal "+(kosong+1)+" belum dijawab");show(kosong);return;}
 clearInterval(interval);
 quizPage.style.display="none";
 resultPage.style.display="block";
 let score=0,html="";
 questions.forEach((q,i)=>{
  const benar=q.answer;
  if(answers[i]===benar) score+=4;
  else html+=`
  <div class="wrong-item">
   <b>Soal ${i+1} salah</b><br><br>
   Jawaban benar: <span class="correct">${benar}</span><br><br>
   ${q.explanation||"-"}
  </div>`;
 });
 const totalQuestions = questions.length;
 const percent = Math.round((score / (totalQuestions * 4)) * 100);
 const dataToSend = {
  waktu: new Date().toLocaleString('id-ID', {timeZone: 'Asia/Jakarta'}),
  namaSiswa: currentUser || "Anonymous",
  code: currentKode || "Unknown",
  kosaKata: "-",
  ubt: "-",
  latihanSoal: `${score}/${totalQuestions*4} (${percent}%)`,
  keterangan: html ? html.replace(/<[^>]+>/g,' ').trim() : "Semua benar! Perfect!"
 };
 fetch(SPREADSHEET_URL, {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify(dataToSend)
 })
 .then(res => res.json())
 .then(data => console.log("Data terkirim ke sheet:", data))
 .catch(err => {
  console.error("Gagal kirim ke sheet:", err);
  const params = new URLSearchParams(dataToSend);
  window.open(SPREADSHEET_URL + "?" + params.toString(), "_blank");
 });
 resultBox.innerHTML=`
  <h2>Nilai: ${score}</h2>
  ${html||"<p class='correct'>Semua jawaban benar üéâ</p>"}
  <div class="back-btn" onclick="location.reload()">KEMBALI</div>`;
};

function startTimer(){
 interval=setInterval(()=>{
  timerEl.textContent=String(Math.floor(time/60)).padStart(2,"0")+":"+String(time%60).padStart(2,"0");
  if(--time<0) submitTop.onclick();
 },1000);
}
});
</script>
</body>
</html>
