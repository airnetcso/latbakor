<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Latihan Reading Korea - 40 Soal</title>
    <style>
        /* Style sama seperti sebelumnya - aku ringkas biar fokus ke script */
        body { font-family: Arial, sans-serif; background: #e8eaf6; margin: 0; padding: 0; color: #333; }
        .container { max-width: 900px; margin: 20px auto; padding: 20px; background: white; box-shadow: 0 0 20px rgba(0,0,0,0.1); border-radius: 16px; }
        /* ... style lainnya copy dari versi sebelumnya ... */
    </style>
</head>
<body>
    <div class="container">
        <h1>Latihan Reading Korea</h1>
        <p style="text-align:center;">40 Soal | 50 Menit</p>

        <div id="login-box" class="active">
            <h2>Masuk</h2>
            <input type="text" id="username" placeholder="Username">
            <input type="password" id="password" placeholder="Password">
            <input type="text" id="kode" placeholder="Kode Soal" maxlength="6">
            <button onclick="login()">Mulai</button>
        </div>

        <div id="quiz-container" style="display:none;">
            <div class="timer" id="timer">Waktu: 50:00</div>
            <div id="loading">Memuat soal...</div>
            <form id="quiz-form"></form>
            <div class="nav-buttons">
                <button id="prev" disabled>◄ Sebelumnya</button>
                <button id="submit" class="submit-btn">Submit</button>
                <button id="next">Berikutnya ►</button>
            </div>
            <div id="result"></div>
        </div>
    </div>

    <script>
        const validCredentials = {
            "uus": "123",
            "kimjong2": "kimju456",
            "siswa01": "tryout26",
            "koreafan": "hanguk789",
            "topik2026": "seoul2026"
        };

        const kodeMapping = {
            "B12345": "soal1.json",
            "A09008": "soal2.json",
            "W11765": "soal3.json",
            "H66633": "soal4.json"
        };

        const GITHUB_RAW_BASE = "https://raw.githubusercontent.com/airnetcso/latbakor/main/soal";

        let questions = [];
        let currentFile = "";

        function login() {
            const user = document.getElementById('username').value.trim();
            const pass = document.getElementById('password').value.trim();
            const kode = document.getElementById('kode').value.trim().toUpperCase();

            if (validCredentials[user] === pass && kodeMapping[kode]) {
                currentFile = kodeMapping[kode];
                document.getElementById('login-box').style.display = 'none';
                document.getElementById('quiz-container').style.display = 'block';
                loadQuestions();
            } else {
                alert("Salah bro! Cek username, password, atau kode soal.");
            }
        }

        async function loadQuestions() {
            const url = `${GITHUB_RAW_BASE}/${currentFile}?t=${Date.now()}`;
            try {
                const res = await fetch(url);
                if (!res.ok) throw new Error("File tidak ditemukan atau error server");
                questions = await res.json();
                console.log("Soal loaded:", questions.length + " soal"); // debug
                renderQuestions();
                document.getElementById('loading').style.display = 'none';
            } catch (err) {
                document.getElementById('loading').innerHTML = `<p style="color:red;">Gagal load soal!</p><p>${err.message}</p><p>URL: ${url}</p>`;
                console.error(err);
            }
        }

        function renderQuestions() {
            const form = document.getElementById('quiz-form');
            form.innerHTML = '';
            questions.forEach((q, i) => {
                let html = `<div class="question"><p><strong>Passage ${i+1}:</strong> ${q.passage}</p>`;
                if (q.audio) html += `<audio controls><source src="${q.audio}"></audio>`;
                if (q.image) html += `<img src="${q.image}">`;
                html += `<p><strong>Question ${i+1}:</strong> ${q.question}</p><div class="options">`;
                for (let key in q.options) {
                    html += `<label><input type="radio" name="q${i}" value="${key}"> ${key}. ${q.options[key]}</label>`;
                }
                html += `</div></div>`;
                form.innerHTML += html;
            });
        }

        // Timer, submit, review dll copy dari versi sebelumnya
    </script>
</body>
</html>
